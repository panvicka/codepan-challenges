function throttle(callback, interval) {
  let enableCall = true;

  return function (...args) {
    if (!enableCall) return;

    enableCall = false;
    callback.apply(this, args);
    setTimeout(() => (enableCall = true), interval);
  };
}

function calculateDistanceFromCoordinates(
  xA: number,
  yA: number,
  xB: number,
  yB: number
) {
  return Math.sqrt(Math.pow(xA - xB, 2) + Math.pow(yA - yB, 2));
}

class MouseInfo {
  mouseX: number;
  mouseY: number;
  lastX: number;
  lastY: number;
  xDiff: number;
  yDiff: number;
}

const mouseInfo = new MouseInfo();
const containerDiv = document.querySelector<HTMLInputElement>(".container");
const img = document.querySelector<HTMLInputElement>("img");

img.addEventListener("mouseenter", () => {
  img.src =
    "data:image/svg+xml;base64,PHN2ZyBpZD0iQ2FwYV8xIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1MTIgNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHdpZHRoPSI1MTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGc+PGc+PHBhdGggZD0ibTQwLjAxMSAyMDUuMDY2aDQzMS45Nzh2MjM2LjQ4NWgtNDMxLjk3OHoiIGZpbGw9IiNmOWY1ZjMiLz48L2c+PGc+PHBhdGggZD0ibTEwIDE2My4wMDloNDkydjQyLjA1OGgtNDkyeiIgZmlsbD0iI2ZmN2U5NiIvPjwvZz48Zz48cGF0aCBkPSJtMTk5LjgwMSAzMjcuMzQzaC04Mi42NjhjLTEwLjYyNCAwLTE5LjIzNi04LjYxMi0xOS4yMzYtMTkuMjM2IDAtMTAuNjI0IDguNjEyLTE5LjIzNiAxOS4yMzYtMTkuMjM2aDgyLjY2OGMxMC42MjQgMCAxOS4yMzYgOC42MTIgMTkuMjM2IDE5LjIzNiAwIDEwLjYyMy04LjYxMiAxOS4yMzYtMTkuMjM2IDE5LjIzNnoiIGZpbGw9IiNmZjlkYjAiLz48L2c+PGc+PHBhdGggZD0ibTE1OC4zNzkgNDE5LjUwOWMwIDUyLjQ2LTYxLjkyNCA3Ny42MTUtNjEuOTI0IDc3LjYxNWgxMjMuODA1cy02MS44ODEtMjUuMTU1LTYxLjg4MS03Ny42MTV6IiBmaWxsPSIjZjlmNWYzIi8+PC9nPjxnPjxwYXRoIGQ9Im0zOTUuMDg2IDMyNy4zNDNoLTgyLjY2OGMtMTAuNjI0IDAtMTkuMjM2LTguNjEyLTE5LjIzNi0xOS4yMzYgMC0xMC42MjQgOC42MTItMTkuMjM2IDE5LjIzNi0xOS4yMzZoODIuNjY4YzEwLjYyNCAwIDE5LjIzNiA4LjYxMiAxOS4yMzYgMTkuMjM2IDAgMTAuNjIzLTguNjEyIDE5LjIzNi0xOS4yMzYgMTkuMjM2eiIgZmlsbD0iI2ZmOWRiMCIvPjwvZz48Zz48cGF0aCBkPSJtMzUzLjY2NSA0MTkuNTA5YzAgNTIuNDYtNjEuOTI0IDc3LjYxNS02MS45MjQgNzcuNjE1aDEyMy44MDVjLS4wMDEgMC02MS44ODEtMjUuMTU1LTYxLjg4MS03Ny42MTV6IiBmaWxsPSIjZjlmNWYzIi8+PC9nPjxnPjxwYXRoIGQ9Im0zMjYuMjYyIDE2Mi44aC0xOC4yNTJjLTExLjE5NSAwLTIwLjI3LTkuMDc1LTIwLjI3LTIwLjI3di01Ni4yNzJoNTguNzkzdjU2LjI3MWMwIDExLjE5NS05LjA3NiAyMC4yNzEtMjAuMjcxIDIwLjI3MXoiIGZpbGw9IiNjYmY0ZmIiLz48L2c+PGc+PHBhdGggZD0ibTIxMi42NiA1OC43MDUtNC45Ni00My44MjloLTI5LjIyOGwtNC45NiA0My44MjljLS40OTMgNC4zNTQtMi4xMTggOC40NDgtNC42NzQgMTEuNzdsLTUuNTM5IDcuMjAxYy0zLjExNyA0LjA1Mi00LjgzMiA5LjIyOC00LjgzMiAxNC41ODF2NTIuODY4YzAgOS43NjIgNy4wNTEgMTcuNjc1IDE1Ljc0OSAxNy42NzVoMzcuNzRjOC42OTggMCAxNS43NDktNy45MTMgMTUuNzQ5LTE3LjY3NXYtNTIuODY4YzAtNS4zNTQtMS43MTUtMTAuNTI5LTQuODMyLTE0LjU4MWwtNS41MzktNy4yMDFjLTIuNTU2LTMuMzIyLTQuMTgyLTcuNDE2LTQuNjc0LTExLjc3eiIgZmlsbD0iI2ZmZDg4YSIvPjwvZz48Zz48cGF0aCBkPSJtNTAyIDE1My4wMDloLTE0Ny4zNGMxLjIwOS0zLjI2NyAxLjg3Mi02Ljc5NyAxLjg3Mi0xMC40Nzl2LThoOC44MzNjMTYuMDY1IDAgMjkuMTM1LTEzLjA3IDI5LjEzNS0yOS4xMzVzLTEzLjA2OS0yOS4xMzUtMjkuMTM1LTI5LjEzNWgtNzcuNjI1Yy01LjUyMiAwLTEwIDQuNDc3LTEwIDEwdjU2LjI3MWMwIDMuNjgyLjY2MyA3LjIxMiAxLjg3MiAxMC40NzloLTQyLjk3OWMuNjkzLTIuNSAxLjA3LTUuMTQ1IDEuMDctNy44ODR2LTUyLjg2OWMwLTcuNTQ1LTIuNDUzLTE0Ljg4OS02LjkwNi0yMC42NzhsLTUuNTM5LTcuMjAxYy0xLjQ1My0xLjg4OS0yLjM3NC00LjIzOS0yLjY2NC02Ljc5N2wtMy44Ny0zNC4xOWMyLjg2MS0xLjc2IDQuNzc1LTQuOTEgNC43NzUtOC41MTUgMC01LjUyMy00LjQ3Ny0xMC0xMC0xMGgtNDAuODMzYy01LjUyMyAwLTEwIDQuNDc3LTEwIDEwIDAgMy42MDUgMS45MTQgNi43NTUgNC43NzUgOC41MTVsLTMuODY5IDM0LjE5Yy0uMjkgMi41NTgtMS4yMSA0LjkwOC0yLjY2NCA2Ljc5N2wtNS41NCA3LjIwMWMtNC40NTMgNS43OS02LjkwNSAxMy4xMzMtNi45MDUgMjAuNjc4djUyLjg2OGMwIDIuNzM5LjM3OCA1LjM4NCAxLjA3IDcuODg0aC0xMzkuNTMzYy01LjUyMyAwLTEwIDQuNDc3LTEwIDEwdjQyLjA1OGMwIDUuNTIzIDQuNDc3IDEwIDEwIDEwaDIwLjAxMXYyMjYuNDg1YzAgNS41MjMgNC40NzcgMTAgMTAgMTBoOTguMTk0Yy0xNS45NTkgMjMuOTA0LTQ1LjEyMSAzNi4xNDYtNDUuNTE0IDM2LjMwOC00LjQzMiAxLjgtNi45NjggNi40ODctNi4wNTEgMTEuMTgyczUuMDMxIDguMDgzIDkuODE0IDguMDgzaDEyMy44MDZjNC43NzcgMCA4Ljg3OC0zLjM4MSA5LjgwMy04LjA2OC45MjQtNC42ODctMS42MDMtOS4zNzUtNi4wMjItMTEuMTg5LS40MDQtLjE2Ni0yOS41NDgtMTIuNDA5LTQ1LjQ5Ni0zNi4zMTVoMTU0Ljk0NmMtMTUuOTU5IDIzLjkwNC00NS4xMjEgMzYuMTQ2LTQ1LjUxNSAzNi4zMDgtNC40MzIgMS44LTYuOTY4IDYuNDg3LTYuMDUxIDExLjE4MnM1LjAzMSA4LjA4MyA5LjgxNCA4LjA4M2gxMjMuODA1YzQuNzgzIDAgOC44OTYtMy4zODcgOS44MTQtOC4wODIuOTE3LTQuNjk0LTEuNjE3LTkuMzgxLTYuMDQ5LTExLjE4Mi0uNDA1LS4xNjUtMjkuNjE1LTEyLjMyMi00NS41NDUtMzYuMzA5aDk4LjIyNGM1LjUyMiAwIDEwLTQuNDc3IDEwLTEwdi0yMjYuNDg3aDIwLjAxMmM1LjUyMiAwIDEwLTQuNDc3IDEwLTEwdi00Mi4wNThjMC01LjUyMi00LjQ3OC05Ljk5OS0xMC05Ljk5OXptLTEyNy41LTQ3LjYxNWMwIDUuMDM3LTQuMDk4IDkuMTM1LTkuMTM1IDkuMTM1aC04LjgzM3YtMTguMjcxaDguODMzYzUuMDM3IDAgOS4xMzUgNC4wOTggOS4xMzUgOS4xMzZ6bS03Ni43Ni05LjEzNmgzOC43OTJ2NDYuMjcxYzAgNS42NjMtNC42MDcgMTAuMjcxLTEwLjI3MSAxMC4yNzFoLTE4LjI1MWMtNS42NjMgMC0xMC4yNzEtNC42MDctMTAuMjcxLTEwLjI3MXYtNDYuMjcxem0tOTguOTczLTcxLjM4MiAzLjk1NiAzNC45NTRjLjY5OSA2LjE3NyAzLjAxIDExLjk2NyA2LjY4NCAxNi43NDJsNS41MzkgNy4yMDFjMS43NzkgMi4zMTIgMi43NTggNS4zMjUgMi43NTggOC40ODR2NTIuODY4YzAgNC4xNi0yLjYzMiA3LjY3NS01Ljc0OSA3LjY3NWgtMzcuNzRjLTMuMTE2IDAtNS43NDktMy41MTUtNS43NDktNy42NzV2LTUyLjg2OGMwLTMuMTU4Ljk3OS02LjE3MSAyLjc1OC04LjQ4NGw1LjU0LTcuMjAxYzMuNjczLTQuNzc3IDUuOTg1LTEwLjU2NiA2LjY4NC0xNi43NDJsMy45NTYtMzQuOTU0em0tMTQuMDY5IDQ2Mi4yNDhoLTUyLjY2MWMuNTg3LS40NzEgMS4xNzctLjk1MSAxLjc2Ni0xLjQzOSAxMC41NTgtOC43NjEgMTguNzkzLTE4LjQxOSAyNC41NzMtMjguNzIgNS43NzYgMTAuMzAxIDE0LjAwNSAxOS45NTcgMjQuNTU1IDI4LjcxOC41ODkuNDg4IDEuMTc5Ljk2OSAxLjc2NyAxLjQ0MXptMTk1LjI4NSAwaC01Mi42NjFjLjU4OC0uNDcxIDEuMTc4LS45NTEgMS43NjctMS40MzkgMTAuNTU4LTguNzYxIDE4Ljc5My0xOC40MTkgMjQuNTczLTI4LjcyIDUuNzc1IDEwLjMwMSAxNC4wMDQgMTkuOTU3IDI0LjU1NSAyOC43MTguNTg5LjQ4OCAxLjE3OS45NjkgMS43NjYgMS40NDF6bTExMi4wMTctMjkyLjA1OGgtMTkxLjY1NWMtNS41MjIgMC0xMCA0LjQ3Ny0xMCAxMHM0LjQ3OCAxMCAxMCAxMGgxNjEuNjQ1djIxNi40ODVoLTk2Ljk4Yy0uODQyLTMuNzE2LTEuMzEzLTcuNjE3LTEuMzM4LTExLjY5OGwuMDA4LTguOTM2aDMxLjEwMmM1LjUyMiAwIDEwLTQuNDc3IDEwLTEwcy00LjQ3OC0xMC0xMC0xMGgtMzEuMDg0bC4wNDctNTMuNTc1aDMxLjM0M2MxNi4xMjEgMCAyOS4yMzYtMTMuMTE1IDI5LjIzNi0yOS4yMzZzLTEzLjExNS0yOS4yMzYtMjkuMjM2LTI5LjIzNmgtODIuNjY4Yy0xNi4xMjEgMC0yOS4yMzYgMTMuMTE1LTI5LjIzNiAyOS4yMzZzMTMuMTE1IDI5LjIzNiAyOS4yMzYgMjkuMjM2aDMxLjMyNWwtLjA0NyA1My41NzVoLTMxLjQxMWMtNS41MjIgMC0xMCA0LjQ3Ny0xMCAxMHM0LjQ3OCAxMCAxMCAxMGgzMS4zOTNsLS4wMDcgOC40NTRjLS4wMDEuMDQ2LS4wMDcuMDkxLS4wMDcuMTM3IDAgNC4yMDUtLjQ4MiA4LjIyLTEuMzU3IDEyLjA0MmgtMTcyLjU3NWMtLjg0OS0zLjcxOC0xLjMyMy03LjYxOC0xLjM0OS0xMS42OThsLjAwOC04LjkzNmgzMS4xMDJjNS41MjMgMCAxMC00LjQ3NyAxMC0xMHMtNC40NzctMTAtMTAtMTBoLTMxLjA4NWwuMDQ3LTUzLjU3NWgzMS4zNDNjMTYuMTIxIDAgMjkuMjM2LTEzLjExNSAyOS4yMzYtMjkuMjM2cy0xMy4xMTUtMjkuMjM2LTI5LjIzNi0yOS4yMzZoLTgyLjY2OGMtMTYuMTIxIDAtMjkuMjM2IDEzLjExNS0yOS4yMzYgMjkuMjM2czEzLjExNSAyOS4yMzYgMjkuMjM2IDI5LjIzNmgzMS4zMjVsLS4wNDcgNTMuNTc1aC0zMS40MWMtNS41MjMgMC0xMCA0LjQ3Ny0xMCAxMHM0LjQ3NyAxMCAxMCAxMGgzMS4zOTNsLS4wMDcgOC40NTNjLS4wMDEuMDQ3LS4wMDcuMDkyLS4wMDcuMTM4IDAgNC4yMDUtLjQ4MiA4LjIyLTEuMzU3IDEyLjA0MmgtOTcuMDExdi0yMTYuNDgzaDE2Mi4zMzRjNS41MjMgMCAxMC00LjQ3NyAxMC0xMHMtNC40NzctMTAtMTAtMTBoLTE5Mi4zNDV2LTIyLjA1OGg0NzJ6bS0xNzkuNTgyIDEyMi4yNzdjLTUuMDkzIDAtOS4yMzYtNC4xNDQtOS4yMzYtOS4yMzZzNC4xNDQtOS4yMzYgOS4yMzYtOS4yMzZoODIuNjY4YzUuMDkzIDAgOS4yMzYgNC4xNDQgOS4yMzYgOS4yMzZzLTQuMTQ0IDkuMjM2LTkuMjM2IDkuMjM2em0tMTk1LjI4NiAwYy01LjA5MyAwLTkuMjM2LTQuMTQ0LTkuMjM2LTkuMjM2czQuMTQ0LTkuMjM2IDkuMjM2LTkuMjM2aDgyLjY2OGM1LjA5MyAwIDkuMjM2IDQuMTQ0IDkuMjM2IDkuMjM2cy00LjE0NCA5LjIzNi05LjIzNiA5LjIzNnoiLz48cGF0aCBkPSJtMjUwLjQ1IDIxMy4zOGMzLjY5NyAyLjQ2NCA4LjcxMiAyLjE1NiAxMi4wOC0uNzQzIDIuOTkyLTIuNTc1IDQuMTk2LTYuODE2IDMuMDAyLTEwLjU3OC0xLjI3Ny00LjAyMi01LjA1Ny02Ljg4My05LjI4Mi02Ljk4OC00LjI0OC0uMTA2LTguMTgzIDIuNTkyLTkuNjM5IDYuNTc2LTEuNTUzIDQuMjQ4LjAzNSA5LjI0MyAzLjgzOSAxMS43MzN6Ii8+PC9nPjwvZz48L3N2Zz4=";
});

img.addEventListener("mouseleave", () => {
  img.src =
    "data:image/svg+xml;base64,PHN2ZyBpZD0iQ2FwYV8xIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA1MTIgNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHdpZHRoPSI1MTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGc+PGc+PHBhdGggZD0ibTUwMiAxNTMuMDA5aC0xNDcuMzRjMS4yMDktMy4yNjcgMS44NzItNi43OTcgMS44NzItMTAuNDc5di04aDguODMzYzE2LjA2NSAwIDI5LjEzNS0xMy4wNyAyOS4xMzUtMjkuMTM1cy0xMy4wNjktMjkuMTM1LTI5LjEzNS0yOS4xMzVoLTc3LjYyNWMtNS41MjIgMC0xMCA0LjQ3Ny0xMCAxMHY1Ni4yNzFjMCAzLjY4Mi42NjMgNy4yMTIgMS44NzIgMTAuNDc5aC00Mi45NzljLjY5My0yLjUgMS4wNy01LjE0NSAxLjA3LTcuODg0di01Mi44NjljMC03LjU0NS0yLjQ1My0xNC44ODktNi45MDYtMjAuNjc4bC01LjUzOS03LjIwMWMtMS40NTMtMS44ODktMi4zNzQtNC4yMzktMi42NjQtNi43OTdsLTMuODctMzQuMTljMi44NjEtMS43NiA0Ljc3NS00LjkxIDQuNzc1LTguNTE1IDAtNS41MjMtNC40NzctMTAtMTAtMTBoLTQwLjgzM2MtNS41MjMgMC0xMCA0LjQ3Ny0xMCAxMCAwIDMuNjA1IDEuOTE0IDYuNzU1IDQuNzc1IDguNTE1bC0zLjg2OSAzNC4xOWMtLjI5IDIuNTU4LTEuMjEgNC45MDgtMi42NjQgNi43OTdsLTUuNTQgNy4yMDFjLTQuNDUzIDUuNzktNi45MDUgMTMuMTMzLTYuOTA1IDIwLjY3OHY1Mi44NjhjMCAyLjczOS4zNzggNS4zODQgMS4wNyA3Ljg4NGgtMTM5LjUzM2MtNS41MjMgMC0xMCA0LjQ3Ny0xMCAxMHY0Mi4wNThjMCA1LjUyMyA0LjQ3NyAxMCAxMCAxMGgyMC4wMTF2MjI2LjQ4NWMwIDUuNTIzIDQuNDc3IDEwIDEwIDEwaDk4LjE5NGMtMTUuOTU5IDIzLjkwNC00NS4xMjEgMzYuMTQ2LTQ1LjUxNCAzNi4zMDgtNC40MzIgMS44LTYuOTY4IDYuNDg3LTYuMDUxIDExLjE4MnM1LjAzMSA4LjA4MyA5LjgxNCA4LjA4M2gxMjMuODA2YzQuNzc3IDAgOC44NzgtMy4zODEgOS44MDMtOC4wNjguOTI0LTQuNjg3LTEuNjAzLTkuMzc1LTYuMDIyLTExLjE4OS0uNDA0LS4xNjYtMjkuNTQ4LTEyLjQwOS00NS40OTYtMzYuMzE1aDE1NC45NDZjLTE1Ljk1OSAyMy45MDQtNDUuMTIxIDM2LjE0Ni00NS41MTUgMzYuMzA4LTQuNDMyIDEuOC02Ljk2OCA2LjQ4Ny02LjA1MSAxMS4xODJzNS4wMzEgOC4wODMgOS44MTQgOC4wODNoMTIzLjgwNWM0Ljc4MyAwIDguODk2LTMuMzg3IDkuODE0LTguMDgyLjkxNy00LjY5NC0xLjYxNy05LjM4MS02LjA0OS0xMS4xODItLjQwNS0uMTY1LTI5LjYxNS0xMi4zMjItNDUuNTQ1LTM2LjMwOWg5OC4yMjRjNS41MjIgMCAxMC00LjQ3NyAxMC0xMHYtMjI2LjQ4N2gyMC4wMTJjNS41MjIgMCAxMC00LjQ3NyAxMC0xMHYtNDIuMDU4YzAtNS41MjItNC40NzgtOS45OTktMTAtOS45OTl6bS0xMjcuNS00Ny42MTVjMCA1LjAzNy00LjA5OCA5LjEzNS05LjEzNSA5LjEzNWgtOC44MzN2LTE4LjI3MWg4LjgzM2M1LjAzNyAwIDkuMTM1IDQuMDk4IDkuMTM1IDkuMTM2em0tNzYuNzYtOS4xMzZoMzguNzkydjQ2LjI3MWMwIDUuNjYzLTQuNjA3IDEwLjI3MS0xMC4yNzEgMTAuMjcxaC0xOC4yNTFjLTUuNjYzIDAtMTAuMjcxLTQuNjA3LTEwLjI3MS0xMC4yNzF2LTQ2LjI3MXptLTk4Ljk3My03MS4zODIgMy45NTYgMzQuOTU0Yy42OTkgNi4xNzcgMy4wMSAxMS45NjcgNi42ODQgMTYuNzQybDUuNTM5IDcuMjAxYzEuNzc5IDIuMzEyIDIuNzU4IDUuMzI1IDIuNzU4IDguNDg0djUyLjg2OGMwIDQuMTYtMi42MzIgNy42NzUtNS43NDkgNy42NzVoLTM3Ljc0Yy0zLjExNiAwLTUuNzQ5LTMuNTE1LTUuNzQ5LTcuNjc1di01Mi44NjhjMC0zLjE1OC45NzktNi4xNzEgMi43NTgtOC40ODRsNS41NC03LjIwMWMzLjY3My00Ljc3NyA1Ljk4NS0xMC41NjYgNi42ODQtMTYuNzQybDMuOTU2LTM0Ljk1NHptLTE0LjA2OSA0NjIuMjQ4aC01Mi42NjFjLjU4Ny0uNDcxIDEuMTc3LS45NTEgMS43NjYtMS40MzkgMTAuNTU4LTguNzYxIDE4Ljc5My0xOC40MTkgMjQuNTczLTI4LjcyIDUuNzc2IDEwLjMwMSAxNC4wMDUgMTkuOTU3IDI0LjU1NSAyOC43MTguNTg5LjQ4OCAxLjE3OS45NjkgMS43NjcgMS40NDF6bTE5NS4yODUgMGgtNTIuNjYxYy41ODgtLjQ3MSAxLjE3OC0uOTUxIDEuNzY3LTEuNDM5IDEwLjU1OC04Ljc2MSAxOC43OTMtMTguNDE5IDI0LjU3My0yOC43MiA1Ljc3NSAxMC4zMDEgMTQuMDA0IDE5Ljk1NyAyNC41NTUgMjguNzE4LjU4OS40ODggMS4xNzkuOTY5IDEuNzY2IDEuNDQxem0xMTIuMDE3LTI5Mi4wNThoLTE5MS42NTVjLTUuNTIyIDAtMTAgNC40NzctMTAgMTBzNC40NzggMTAgMTAgMTBoMTYxLjY0NXYyMTYuNDg1aC05Ni45OGMtLjg0Mi0zLjcxNi0xLjMxMy03LjYxNy0xLjMzOC0xMS42OThsLjAwOC04LjkzNmgzMS4xMDJjNS41MjIgMCAxMC00LjQ3NyAxMC0xMHMtNC40NzgtMTAtMTAtMTBoLTMxLjA4NGwuMDQ3LTUzLjU3NWgzMS4zNDNjMTYuMTIxIDAgMjkuMjM2LTEzLjExNSAyOS4yMzYtMjkuMjM2cy0xMy4xMTUtMjkuMjM2LTI5LjIzNi0yOS4yMzZoLTgyLjY2OGMtMTYuMTIxIDAtMjkuMjM2IDEzLjExNS0yOS4yMzYgMjkuMjM2czEzLjExNSAyOS4yMzYgMjkuMjM2IDI5LjIzNmgzMS4zMjVsLS4wNDcgNTMuNTc1aC0zMS40MTFjLTUuNTIyIDAtMTAgNC40NzctMTAgMTBzNC40NzggMTAgMTAgMTBoMzEuMzkzbC0uMDA3IDguNDU0Yy0uMDAxLjA0Ni0uMDA3LjA5MS0uMDA3LjEzNyAwIDQuMjA1LS40ODIgOC4yMi0xLjM1NyAxMi4wNDJoLTE3Mi41NzVjLS44NDktMy43MTgtMS4zMjMtNy42MTgtMS4zNDktMTEuNjk4bC4wMDgtOC45MzZoMzEuMTAyYzUuNTIzIDAgMTAtNC40NzcgMTAtMTBzLTQuNDc3LTEwLTEwLTEwaC0zMS4wODVsLjA0Ny01My41NzVoMzEuMzQzYzE2LjEyMSAwIDI5LjIzNi0xMy4xMTUgMjkuMjM2LTI5LjIzNnMtMTMuMTE1LTI5LjIzNi0yOS4yMzYtMjkuMjM2aC04Mi42NjhjLTE2LjEyMSAwLTI5LjIzNiAxMy4xMTUtMjkuMjM2IDI5LjIzNnMxMy4xMTUgMjkuMjM2IDI5LjIzNiAyOS4yMzZoMzEuMzI1bC0uMDQ3IDUzLjU3NWgtMzEuNDFjLTUuNTIzIDAtMTAgNC40NzctMTAgMTBzNC40NzcgMTAgMTAgMTBoMzEuMzkzbC0uMDA3IDguNDUzYy0uMDAxLjA0Ny0uMDA3LjA5Mi0uMDA3LjEzOCAwIDQuMjA1LS40ODIgOC4yMi0xLjM1NyAxMi4wNDJoLTk3LjAxMXYtMjE2LjQ4M2gxNjIuMzM0YzUuNTIzIDAgMTAtNC40NzcgMTAtMTBzLTQuNDc3LTEwLTEwLTEwaC0xOTIuMzQ1di0yMi4wNThoNDcyem0tMTc5LjU4MiAxMjIuMjc3Yy01LjA5MyAwLTkuMjM2LTQuMTQ0LTkuMjM2LTkuMjM2czQuMTQ0LTkuMjM2IDkuMjM2LTkuMjM2aDgyLjY2OGM1LjA5MyAwIDkuMjM2IDQuMTQ0IDkuMjM2IDkuMjM2cy00LjE0NCA5LjIzNi05LjIzNiA5LjIzNnptLTE5NS4yODYgMGMtNS4wOTMgMC05LjIzNi00LjE0NC05LjIzNi05LjIzNnM0LjE0NC05LjIzNiA5LjIzNi05LjIzNmg4Mi42NjhjNS4wOTMgMCA5LjIzNiA0LjE0NCA5LjIzNiA5LjIzNnMtNC4xNDQgOS4yMzYtOS4yMzYgOS4yMzZ6Ii8+PHBhdGggZD0ibTI1MC40NSAyMTMuMzhjMy42OTcgMi40NjQgOC43MTIgMi4xNTYgMTIuMDgtLjc0MyAyLjk5Mi0yLjU3NSA0LjE5Ni02LjgxNiAzLjAwMi0xMC41NzgtMS4yNzctNC4wMjItNS4wNTctNi44ODMtOS4yODItNi45ODgtNC4yNDgtLjEwNi04LjE4MyAyLjU5Mi05LjYzOSA2LjU3Ni0xLjU1MyA0LjI0OC4wMzUgOS4yNDMgMy44MzkgMTEuNzMzeiIvPjwvZz48L2c+PC9zdmc+";
});

const MINIMAL_DIV_WIDTH = 70;
const MAXIMAL_DIV_WIDTH = 90;
const MINIMAL_DIV_HEIGHT = 40;
const MAXIMAL_DIV_HEIGH = 80;
const NUMBER_OF_DIVS = 60;

const DISTANCE_MINIMAL = 80;
const DISTANCE_MAXIMAL = 250;

function generateDivs() {
  for (let i = 0; i < NUMBER_OF_DIVS; i++) {
    const randomWidth = Math.floor(
      Math.random() * (MAXIMAL_DIV_WIDTH - MINIMAL_DIV_WIDTH) +
        MINIMAL_DIV_WIDTH
    );
    const randomheight = Math.floor(
      Math.random() * (MAXIMAL_DIV_HEIGH - MINIMAL_DIV_HEIGHT) +
        MINIMAL_DIV_HEIGHT
    );

    const randomTop = Math.floor(
      Math.random() * (containerDiv.clientHeight - randomheight)
    );
    const randomLeft = Math.floor(
      Math.random() * (containerDiv.clientWidth - randomWidth)
    );
    const newDiv = document.createElement("div");
    newDiv.style.left = `${randomLeft}px`;
    newDiv.style.top = `${randomTop}px`;
    newDiv.style.width = `${randomWidth}px`;
    newDiv.style.height = `${randomheight}px`;
    newDiv.classList.add("test-div");
    containerDiv.appendChild(newDiv);
  }
}

function saveMousePosition(e: MouseEvent) {
  mouseInfo.mouseX = e.clientX;
  mouseInfo.mouseY = e.clientY;

  mouseInfo.xDiff = mouseInfo.lastX - mouseInfo.mouseX;
  mouseInfo.yDiff = mouseInfo.lastY - mouseInfo.mouseY;

  mouseInfo.lastX = mouseInfo.mouseX;
  mouseInfo.lastY = mouseInfo.mouseY;
}

function handleDivMovement(div: HTMLElement) {
  const randomTopOffset = Math.floor(Math.random() * 5);
  const randomLeftOffset = Math.floor(Math.random() * 10);

  const newTopPosition = div.offsetTop - mouseInfo.yDiff + randomTopOffset;
  const newLeftPosition = div.offsetLeft - mouseInfo.xDiff + randomLeftOffset;

  if (newLeftPosition < 0) {
    div.style.left = `0px`;
  } else if (newLeftPosition > containerDiv.clientWidth - div.clientWidth) {
    div.style.left = `${containerDiv.clientWidth - div.clientWidth}px`;
  } else {
    div.style.left = `${newLeftPosition}px`;
  }

  if (newTopPosition < 0) {
    div.style.top = `0px`;
  } else if (newTopPosition > containerDiv.clientHeight - div.clientHeight) {
    div.style.top = `${containerDiv.clientHeight - div.clientHeight}px`;
  } else {
    div.style.top = `${div.offsetTop - mouseInfo.yDiff}px`;
  }
}

function calculateDistanceFromPointer(div: HTMLElement) {
  return calculateDistanceFromCoordinates(
    mouseInfo.lastX,
    mouseInfo.lastY,

    div.getBoundingClientRect().x + div.clientHeight / 2,
    div.getBoundingClientRect().y + div.clientWidth / 2
  );
}

function handleMouseMove(e) {
  saveMousePosition(e);

  const allDivs = document.querySelectorAll<HTMLElement>(".test-div")!;

  allDivs.forEach((div) => {
    const distanceFromPointer = calculateDistanceFromPointer(div);

    if (
      distanceFromPointer <
      Math.floor(Math.random() * (DISTANCE_MAXIMAL - DISTANCE_MINIMAL)) +
        DISTANCE_MINIMAL
    ) {
      handleDivMovement(div);
    }
  });
}

containerDiv.addEventListener("mousemove", throttle(handleMouseMove, 300));

window.addEventListener("load", generateDivs);
